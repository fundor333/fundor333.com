---
title: "Letterhead With ReportLab"
date: 2021-05-10T14:12:14+02:00
feature_image: "Letterhead-with-ReportLab.jpg"
feature_link: "https://unsplash.com/photos/XtDKGqK3uaA"
feature_text: "Photo by Mae Mu on Unsplash"
tags:
- coding
- python
- reportlab
slug: "Letterhead-with-ReportLab"
description: "Sometime you need to have a letterhead document generated by your application and here we explain how to make it with Reportlab"
type: "post"
---

Sometime you need to make some pdf looking more professional. 
In python you use the ReportLab[^1] package for make Pdf.
[^1]: [ReportLab](https://www.reportlab.com/opensource/) is an opensource engine for Pdf documents. The python package is [here](https://www.reportlab.com/dev/docs/)

``` python
class BasicPaper:
    def __init__(self, buffer, pagesize="A4"):
        self.buffer = buffer
        if pagesize == "A4":
            self.pagesize = A4
        elif pagesize == "Letter":
            self.pagesize = letter
        else:
            self.pagesize = A4
        self.width, self.height = self.pagesize

    @staticmethod
    def _header_footer(canvas, doc):
        # Save the state of our canvas so we can draw on it
        BasicPaper.header(canvas, doc)
        BasicPaper.footer(canvas, doc)

        canvas.saveState()
        # Release the canvas
        canvas.restoreState()

    @staticmethod
    def header(canvas, doc):
        # Save the state of our canvas so we can draw on it
        canvas.saveState()

        # Header
        header = Image("letterhead_header.jpg", 600, 60)
        header.drawOn(
            canvas, doc.leftMargin - 2 * cm, doc.height + doc.topMargin + 2 * cm
        )

        canvas.restoreState()

    @staticmethod
    def footer(canvas, doc):
        canvas.saveState()

        # Footer
        footer = Image("letterhead_footer.jpg", 600, 60)
        w, h = footer.wrap(doc.width, doc.bottomMargin)
        footer.drawOn(canvas, doc.leftMargin - 2 * cm, h - 2 * cm)

        # Release the canvas
        canvas.restoreState()
```


``` python
class RimborsoSpesePrinter(BasicPrinter):
    @staticmethod
    def _header_footer(canvas, doc):
        # Save the state of our canvas so we can draw on it
        RimborsoSpesePrinter.header(canvas, doc)
        RimborsoSpesePrinter.footer(canvas, doc)

    def get_pdf(self, segnalazione_ufficio):
        buffer = self.buffer
		styles = getSampleStyleSheet()

        doc = SimpleDocTemplate(buffer)

        elements = []

        elements.append(Paragraph("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi sed sem ornare, dictum sapien at, egestas sapien. Nullam faucibus eleifend finibus. Vivamus vel sapien urna.", style=styles["Normal"]))
        doc.build(
            elements, onFirstPage=self._header_footer, onLaterPages=self._header_footer
        )

        pdf = buffer.getvalue()
        buffer.close()
        return pdf
```
